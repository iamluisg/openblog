---
import { getCollection } from 'astro:content'
import BaseLayout from '@/layouts/BaseLayout'
import TitlePage from '@/components/TitlePage'
import ProjectCard from '@/components/ProjectCard'

const meta = {
	title: 'Projects',
	description: 'A showcase of applications and projects I have built.'
}

// Get all projects from content collection, exclude drafts
const allProjects = await getCollection('projects', ({ data }) => !data.draft)

// Sort by publication date (newest first)
const projects = allProjects.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
---

<BaseLayout title={meta.title} description={meta.description}>
	<TitlePage title='Projects' />

	<!-- Intro Section -->
	<section class='prose dark:prose-invert max-w-none mt-1'>
		<p class='text-lg'>
			Here's a collection of personal applications and projects I've built over the years.
		</p>
	</section>

	<!-- Projects Grid -->
	<section class='grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 mt-4'>
		{
			projects.map((project) => (
				<ProjectCard
					title={project.data.title}
					description={project.data.description}
					heroImage={project.data.heroImage}
					tags={project.data.tags}
					slug={project.slug}
					liveUrl={project.data.liveUrl}
					demoUrl={project.data.demoUrl}
					githubUrl={project.data.githubUrl}
				/>
			))
		}
	</section>
</BaseLayout>
